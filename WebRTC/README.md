
# _

WebRTC 是一个支持网页浏览器进行实时语音对话或视频对话的 API 。并在 Google 、 Mozilla 、 Opera 支持下被纳入万维网联盟的 W3C 推荐标准。

其实除了语音视频通话，它还能传输文件数据。

有一个比较好的中文网站： [https://webrtc.org.cn/](https://webrtc.org.cn/) 。里面包含简单的文档和不错的 demo 。

</br>
</br>
</br>

一般来说，我们需要知道对方的网络地址才能连接到它，这过程可能会比较复杂，因为会经过很多个路由网关。幸运的是， WebRTC 中的发送信令和交涉已经解决了这个问题。

发送信令的过程由以下几个步骤组成：

1. 为一个对等连接创建潜在的**候选列表**。
2. 用户或计算机算法将选择一个用户去连接。
3. 信令层将**通知**那个用户，有人想要连接他，用户可以接受或拒绝。
4. 当连接的请求被接受时，第一个用户会被通知。
5. 若接受，第一个用户将初始化 RTCPeerConnection 。
6. 双方将通过信令通道**交换**各自电脑的**硬件和软件信息**。
7. 双方将通信信令通道**交换**各自电脑脑的**位置信息**。
8. 用户之间的连接将成功或失败。

会话描述协议(**SDP**)，是由浏览器提供的基于字符串的二进制数据对象，涵盖了一个指定用户的描述、时间配置和媒体的限制。字符串的形式是一系列的键值对，由换行符分割。大概长这样：

``` txt
v=0
o=- 116782650034916900 2 IN IP4 127.0.0.1
......
```

NAT 会话穿透工具（**STUN**）：

- 它是双方建立稳定连接的第一步。
- 它有助于在互联网上识别对方，同时在创建对等连接时常被其他协议使用。
- 首先发一个请求服务器，以开启 STUN 协议。
- 之后服务器识别发出请求的客户端的 IP 地址，并将其返回给客户端。
- 客户端之后可以通过返回的 IP 地址来识别自己。
- 使用 STUN 协议需要一个支持 STUN 协议的服务器。目前在 Firefox 和 Chrome 中直接提供了支持此协议的默认服务器。

中继技术穿透 NAT （**TURN**）：

- 工作原理是代表客户端在对等连接的双方之间增加一个转播，客户端之后从 TURN 服务器得到信息。
- 这是用来建立 WebRTC 连接的最后一种手段，因为高质量的 TURN 服务器代价很大。
- 大部分情况下，不使用 TURN 不会有任何问题。

**ICE** ： STUN 和 TURN 结合在一起的标准就是 ICE ，寻找一系列双方可用的地址并按顺序测试每一个地址，直到找到一个双方都可以用的组合。
